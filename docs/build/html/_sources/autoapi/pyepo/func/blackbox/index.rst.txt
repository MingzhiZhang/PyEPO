:mod:`pyepo.func.blackbox`
==========================

.. py:module:: pyepo.func.blackbox

.. autoapi-nested-parse::

   Differentiable Black-box optimization function



Module Contents
---------------

Classes
~~~~~~~

.. autoapisummary::

   pyepo.func.blackbox.blackboxOpt



Functions
~~~~~~~~~

.. autoapisummary::

   pyepo.func.blackbox.solveWithObj4Par
   pyepo.func.blackbox._solve_in_pass
   pyepo.func.blackbox._cache_in_pass


.. function:: solveWithObj4Par(cost, args, model_type)

   A global function to solve function in parallel processors

   :param cost: cost of objective function
   :type cost: np.ndarray
   :param args: optModel args
   :type args: dict
   :param model_type: optModel class type
   :type model_type: ABCMeta

   :returns: optimal solution
   :rtype: list


.. py:class:: blackboxOpt(optmodel, lambd=10, processes=1, solve_ratio=1, dataset=None)

   Bases: :class:`torch.autograd.Function`

   A autograd function for differentiable black-box optimizer, which yield
   optimal a solution and derive a gradient.

   For differentiable block-box, the objective function is linear and
   constraints are known and fixed, but the cost vector need to be predicted
   from contextual data.

   The block-box approximate gradient of optimizer smoothly. Thus, allows us to
   design an algorithm based on stochastic gradient descent.

   .. method:: forward(ctx, pred_cost)
      :staticmethod:

      Forward pass in neural network.

      :param pred_cost: a batch of predicted values of the cost
      :type pred_cost: torch.tensor

      :returns: predicted solutions
      :rtype: torch.tensor


   .. method:: backward(ctx, grad_output)
      :staticmethod:

      Backward pass in neural network



.. function:: _solve_in_pass(cp)

   A function to solve optimization in the forward/backward pass


.. function:: _cache_in_pass(c)

   A function to use solution pool in the forward/backward pass


